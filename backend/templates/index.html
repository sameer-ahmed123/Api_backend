<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Api testing</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>

<body>

    <button id="lod_emp">load employee</button>

    <div id="main_div"></div>

    </div>
    <a href="">delete</a>

    <button id="delete_employee">dlete</button>

    <script>
        const dle_btn = document.getElementById("delete_employee")
        let id = 8
        let endp = `http://localhost:8000/api/delete/${id}/`
        let options = {
            method: 'DELETE', // The HTTP method to use
        }

        dle_btn.addEventListener("click", () => {
            fetch(endp, options)
                .then(response => {
                    if (!response.ok) {
                        console.log("could not delete the employee")
                    }
                    else {
                        console.log(response.status)
                        alert("deleted an employee")
                        return response.json()
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });
        })


    </script>

    <script>
        const endpoint = "http://localhost:8000/api/empl"

        const load_btn = document.getElementById("lod_emp")
        /* const employee_name = document.getElementById("emp_name")
          const employee_designation = document.getElementById("emp_desig")
          const employee_image = document.getElementById("emp_img")
          const employee_salary = document.getElementById("emp_salary")*/
        const main_div = document.getElementById("main_div")




        load_btn.addEventListener("click", () => {
            fetch(endpoint)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    if (data && data.length > 0) {
                        data.forEach(empl => {
                            // console.log(empl.id)
                            // console.log(empl.image)
                            const created_card = document.createElement("div")
                            created_card.classList.add("card")
                            created_card.style = "height:100vh;display:flex;justify-content:center;align-items:center;flex-direction:column;gap:15px;"


                            var empIMG = document.createElement('img')
                            // Update content based on employee data
                            empIMG.src = empl.image;
                            empIMG.classList.add("card-img-top")
                            empIMG.style = "width:450px;height:350px"

                            var empNAME = document.createElement("p")
                            empNAME.innerText = empl.name;
                            empNAME.classList.add("card-title")

                            var empDESG = document.createElement("p")
                            empDESG.innerText = empl.designation;
                            empDESG.classList.add("card-text")

                            var empSAL = document.createElement("p")
                            empSAL.innerText = empl.salary;
                            empSAL.classList.add("card-text")

                            var ddiv = document.createElement("div")
                            var div = document.createElement("div")
                            div.classList.add("bodcard-y")
                            ddiv.appendChild(empIMG)
                            ddiv.appendChild(empNAME)
                            ddiv.appendChild(empDESG)
                            ddiv.appendChild(empSAL)


                            var empImg = created_card.querySelector(".emp_img");
                            var empName = created_card.querySelector(".emp_name");
                            var empDesig = created_card.querySelector(".emp_desig");
                            var empSalary = created_card.querySelector(".emp_salary");



                            created_card.appendChild(ddiv)
                            main_div.appendChild(created_card)




                        })

                        /*    console.log(data);
                            employee_name.innerText = data.name
                            employee_designation.innerText = data.designation
                            employee_image.src = data.image
                            employee_salary.innerText = data.salary*/
                    }
                    else {
                        console.log("....")
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                });


        })




    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>



</body>

</html>